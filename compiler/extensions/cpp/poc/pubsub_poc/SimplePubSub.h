/**
 * Automatically generated by Zserio C++ extension version 1.4.0-pre2.
 */

#ifndef SIMPLE_PUB_SUB_H
#define SIMPLE_PUB_SUB_H

#include <functional>
#include <string>
#include <vector>
#include <map>

#include "zserio_runtime/IPubSubClient.h"

#include "pubsub_poc/UInt64Value.h"
#include "pubsub_poc/Int32Value.h"
#include "pubsub_poc/BoolValue.h"

namespace pubsub_poc
{

class SimplePubSub
{
public:
    explicit SimplePubSub(::zserio::IPubSubClient& pubSubClient);
    ~SimplePubSub() = default;

    SimplePubSub(const SimplePubSub&) = default;
    SimplePubSub& operator=(const SimplePubSub&) = default;

    SimplePubSub(SimplePubSub&&) = default;
    SimplePubSub& operator=(SimplePubSub&&) = default;

    void publishUint64ValuePub(::pubsub_poc::UInt64Value& object, void* context = nullptr) const;

    void publishInt32ValuePub(::pubsub_poc::Int32Value& object, void* context = nullptr) const;

    void publishBoolValuePub(::pubsub_poc::BoolValue& object, void* context = nullptr) const;

    ::zserio::IPubSubClient::SubscriptionId subscribeUint64ValueSub(
            const std::function<void(const std::string& topic, const ::pubsub_poc::UInt64Value& object)>& callback,
            void* context = nullptr);
    void unsubscribeUint64ValueSub(zserio::IPubSubClient::SubscriptionId id);

    ::zserio::IPubSubClient::SubscriptionId subscribeInt32ValueSub(
            const std::function<void(const std::string& topic, const ::pubsub_poc::Int32Value& object)>& callback,
            void* context = nullptr);
    void unsubscribeInt32ValueSub(zserio::IPubSubClient::SubscriptionId id);

    ::zserio::IPubSubClient::SubscriptionId subscribeBoolValueSub(
            const std::function<void(const std::string& topic, const ::pubsub_poc::BoolValue& object)>& callback,
            void* context = nullptr);
    void unsubscribeBoolValueSub(zserio::IPubSubClient::SubscriptionId id);

private:
    void onRawUint64ValueSub(const std::string& topic, const std::vector<uint8_t>& data) const;
    void onRawInt32ValueSub(const std::string& topic, const std::vector<uint8_t>& data) const;
    void onRawBoolValueSub(const std::string& topic, const std::vector<uint8_t>& data) const;

    template<typename ZSERIO_OBJECT>
    void publishZserioObject(ZSERIO_OBJECT& object, const std::string& topic, void* context) const;

    zserio::IPubSubClient& m_pubSubClient;

    std::map<::zserio::IPubSubClient::SubscriptionId,
            std::function<void(const std::string& topic, const ::pubsub_poc::UInt64Value& object)>> m_subscribersUint64ValueSub;
    std::map<::zserio::IPubSubClient::SubscriptionId,
            std::function<void(const std::string& topic, const ::pubsub_poc::Int32Value& object)>> m_subscribersInt32ValueSub;
    std::map<::zserio::IPubSubClient::SubscriptionId,
            std::function<void(const std::string& topic, const ::pubsub_poc::BoolValue& object)>> m_subscribersBoolValueSub;
};

} // namespace pubsub_poc

#endif // ifndef SIMPLE_PUB_SUB_H
